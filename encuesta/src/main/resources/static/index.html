<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Encuestas">
    <meta name="author" content="Ernaes Antonio Trujillo Vizuet">
    <title>Encuestas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.4/underscore-min.js" integrity="sha512-uLKRd6hCNYAENFn2h7w0p5hrUAz21bAu/85eqSqmQ1Y565lFInwRga9Lgk+QAAR9QvNfSlZjnEb+HHfzkAC/8Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="css/theme.css" rel="stylesheet">
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" width="512" height="512" x="0" y="0" viewBox="0 0 64 64" style="enable-background:new 0 0 512 512;display: none;" xml:space="preserve" class=""><g id="docSvg"><g xmlns="http://www.w3.org/2000/svg"><path d="m12 17c-.552 0-1-.448-1-1 0-2.757 2.243-5 5-5 .552 0 1 .448 1 1s-.448 1-1 1c-1.654 0-3 1.346-3 3 0 .552-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m12 43c-.552 0-1-.448-1-1v-26c0-.552.448-1 1-1s1 .448 1 1v26c0 .552-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m42 13h-26c-.552 0-1-.448-1-1s.448-1 1-1h26c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m46 17c-.552 0-1-.448-1-1 0-1.654-1.346-3-3-3-.552 0-1-.448-1-1s.448-1 1-1c2.757 0 5 2.243 5 5 0 .552-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m46 37.254c-.552 0-1-.448-1-1v-20.254c0-.552.448-1 1-1s1 .448 1 1v20.254c0 .552-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m16 47c-2.757 0-5-2.243-5-5 0-.552.448-1 1-1s1 .448 1 1c0 1.654 1.346 3 3 3 .552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m36.254 47h-20.254c-.552 0-1-.448-1-1s.448-1 1-1h20.254c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m32.511 37h-14.511c-.552 0-1-.448-1-1s.448-1 1-1h14.511c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m40 31h-22c-.552 0-1-.448-1-1s.448-1 1-1h22c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m40 25h-22c-.552 0-1-.448-1-1s.448-1 1-1h22c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m40 19h-22c-.552 0-1-.448-1-1s.448-1 1-1h22c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m44 48c-.552 0-1-.448-1-1v-6c0-.552.448-1 1-1s1 .448 1 1v6c0 .552-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m47 45h-6c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1s-.448 1-1 1z" fill="#8b8b8b" data-original="#000000" class=""></path></g><g xmlns="http://www.w3.org/2000/svg"><path d="m44 53c-4.878 0-9-4.122-9-9s4.122-9 9-9 9 4.122 9 9-4.122 9-9 9zm0-16c-3.794 0-7 3.206-7 7s3.206 7 7 7 7-3.206 7-7-3.206-7-7-7z" fill="#8b8b8b" data-original="#000000" class=""></path></g></g></svg>
</head>
<body>
<main class="d-flex">
    <div id="boxMenu" class="d-flex flex-column align-items-stretch flex-shrink-0 bg-white border-end" >
        <div class="d-flex flex-shrink-0 p-3 justify-content-between ">
            <h3 class="mb-1">Encuestas</h3>
            <div class="btn-group" role="group">
                <button type="button" id="btnNuevaEncuesta" class="btn btn-success">
                    <i class="fa-solid fa-circle-plus"></i>
                    Nueva Encuesta
                </button>
                <button type="button" id="btnRefrescarEncuesta" class="btn btn-light border">
                    <i class="fa-solid fa-arrows-rotate"></i>
                </button>
            </div>
        </div>
        <div class="d-flex align-items-center flex-shrink-0 p-3 border-bottom">
            <div class="form-group has-search" style="width: 100%;">
                <span class="fa fa-search form-control-feedback"></span>
                <input type="text" class="form-control" id="txtBuscar" placeholder="Escribe para buscar y presiona ENTER...">
            </div>
        </div>

        <div id="lstEncuesta" class="list-group list-group-flush border-bottom scrollarea">

        </div>
    </div>
    <div id="boxContent" class="d-flex flex-column flex-grow-1 align-items-stretch flex-shrink-0 bg-light" >
        <div id="boxContentTop" style="padding: 20px 100px 0 100px;"></div>
        <div class="scrollarea" id="boxContentLista" style="padding: 20px 100px;"></div>

    </div>
</main>
<div class="modal fade" id="dlgEncuesta" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="titleDlgEncuesta">Nueva Encuesta</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="frmEncuesta" class="needs-validation" novalidate>
                    <div class="mb-3">
                        <label for="txtNombreEncuesta" class="form-label">Nombre de la Encuesta</label>
                        <input type="hidden" id="txtIdEncuesta"value="-1">
                        <input type="text" class="form-control" id="txtNombreEncuesta" placeholder="" required>
                        <div class="invalid-feedback">
                            Coloque el nombre de la encuesta.
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" id="btnGuardarEncuesta">Guardar</button>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

<!--Inicio Template underscore -->
<script id='tmpItemEncuesta' type='text/html'>
    <a href="javascript:void(0)" onclick="SeleccionarEncuesta(<%= idEncuesta %>)" id="Encuesta_<%= idEncuesta %>" class="list-group-item list-group-item-action  py-3 lh-sm" aria-current="true">
        <div class="d-flex w-100 align-items-center justify-content-between">
            <strong class="mb-1"><%= nombreEncuesta %></strong>
            <small>
                <div class="btn-group" role="group" aria-label="Basic example">
                    <button type="button" onclick="EditarEncuesta(<%= idEncuesta %>);"  class="btn btn-light border editarEncuesta">
                        <i class="fa-solid fa-pen-to-square"></i>
                    </button>
                    <button type="button" onclick="EliminarEncuesta(<%= idEncuesta %>);" class="btn btn-light border eliminaEncuesta">
                        <i class="fa-solid fa-trash-can"></i>
                    </button>

                </div>
            </small>
        </div>
    </a>
</script>
<script id="tmpContentTop" type='text/html'>
    <div class="shadow-sm p-3 mb-3 bg-white rounded">
        <h2 class="mb-3 text-center"><%= nombreEncuesta %></h2>
        <form id="frmPregunta" onsubmit="OnSumitFrmPregunta(event)" class="needs-validation" novalidate>
            <%
            var templateString = $("#cmpNuevaPregunta").html();
            var template = _.template(templateString);
            %>
            <%= template({idEncuesta}) %>
        </form>
    </div>
</script>
<script id="tmpItemPregunta" type='text/html'>
    <div id="Pregunta_<%= pregunta.idPregunta %>" class="shadow-sm p-3 mb-5 bg-white rounded">
        <div class="d-flex justify-content-between border-bottom ">
            <h3 class="mb-3" id="titlePregunta_<%= pregunta.idPregunta %>"><%=pregunta.nombrePregunta%></h3>
            <small>
                <div class="btn-group" role="group" aria-label="Basic example">
                    <button type="button" onclick="EditarPregunta(<%= pregunta.idPregunta %>,<%= idEncuesta %>);"  class="btn btn-light border editarEncuesta">
                        <i class="fa-solid fa-pen-to-square"></i>
                    </button>
                    <button type="button" onclick="EliminarPregunta(<%= pregunta.idPregunta %>);" class="btn btn-light border eliminaEncuesta">
                        <i class="fa-solid fa-trash-can"></i>
                    </button>
                </div>
            </small>
        </div>
        <form id="frmOpcion_<%= pregunta.idPregunta %>" onsubmit="OnSumitFrmOpcion(event,<%= pregunta.idPregunta %>)" class="needs-validation" novalidate>
            <%
            var templateString = $("#cmpNuevoOpcion").html();
            var template = _.template(templateString);
            %>
            <%= template({idPregunta:pregunta.idPregunta}) %>
        </form>
        <div class="m-3 p-3">
            <div class="card w-100">
                <table class="table table-hover" id="tblOpciones_<%= pregunta.idPregunta %>">
                    <tbody>
                    <% _.each(pregunta.opciones, function(opcion){ %>
                    <%= partialTemplate("tmpPartialOpcion",opcion,pregunta.idPregunta) %>
                    <% }); %>
                    </tbody>
                </table>
            </div>
        </div>
</script>
<script id="tmpPartialOpcion" type="text/html">
    <tr id="Opcion_<%= opcion.idOpcion %>">
        <td class="des"><%= opcion.nombreOpcion %></td>
        <td style="width: 100px;">
            <div class="btn-group" role="group">
                <button type="button" onclick="EditarOpcion(<%= idPregunta %>,<%= opcion.idOpcion %>);"  class="btn btn-light border editarEncuesta">
                    <i class="fa-solid fa-pen-to-square"></i>
                </button>
                <button type="button" onclick="EliminarOpcion(<%= opcion.idOpcion %>);" class="btn btn-light border eliminaEncuesta">
                    <i class="fa-solid fa-trash-can"></i>
                </button>
            </div>
        </td>
    </tr>
</script>
<script id="cmpEditarPregunta" type="text/html">
    <input type="hidden" id="txtIdEncuestaSel" value="<%= idEncuesta %>">
    <input type="hidden" id="txtIdPregunta" value="<%= pregunta.idPregunta %>">
    <div class="input-group mb-3 p-2" >
        <input type="text" id="txtNombrePregunta" value="<%= pregunta.nombrePregunta %>" class="form-control" aria-describedby="btnNuevaPregunta" required>
        <button class="btn btn-primary btn-lg" type="submit" id="btnGuardarPregunta">
            <i class="fa-solid fa-floppy-disk"></i>
            Guardado
        </button>
        <button class="btn btn-danger btn-lg" onclick="CancelarEditarPregunta(<%= idEncuesta %>,<%= pregunta.idPregunta %>)" type="button" id="btnCancelarPregunta">
            <i class="fa-solid fa-xmark"></i>
            Cancelar
        </button>
    </div>
</script>
<script id="cmpNuevaPregunta" type="text/html">
    <input type="hidden" id="txtIdEncuestaSel" value="<%= idEncuesta %>">
    <input type="hidden" id="txtIdPregunta" value="-1">
    <div class="input-group mb-3 p-2" >
        <input type="text" id="txtNombrePregunta" placeholder="Coloca una nueva pregunta" class="form-control" aria-describedby="btnNuevaPregunta" required>
        <button class="btn btn-success btn-lg" type="submit" id="btnNuevaPregunta">
            <i class="fa-solid fa-floppy-disk"></i>
            Insertar
        </button>
    </div>
</script>
<script id="cmpEditarOpcion" type="text/html">
    <input type="hidden" id="txtIdOpcion_<%= idPregunta %>" value="<%= opcion.idOpcion %>"/>
    <div class="input-group mb-3 p-3" >
        <input type="text" id="txtNombreOpcion_<%= idPregunta %>" value="<%= opcion.nombreOpcion %>" class="form-control" aria-describedby="btnGuardarOpcion" required>
        <button class="btn btn-primary btn-lg" type="submit" id="btnGuardarOpcion">
            <i class="fa-solid fa-floppy-disk"></i>
            Guardar
        </button>
        <button class="btn btn-danger btn-lg" onclick="CancelarOpcionEditar(<%= idPregunta %>,<%= opcion.idOpcion %>)" type="button" id="btnCancelarOpcion">
            <i class="fa-solid fa-xmark"></i>
            Cancelar
        </button>
    </div>
</script>
<script id="cmpNuevoOpcion" type="text/html">
    <input type="hidden" id="txtIdOpcion_<%= idPregunta %>" value="-1"/>
    <div class="input-group mb-3 p-3">
        <input type="text" id="txtNombreOpcion_<%= idPregunta %>" placeholder="Coloca el nombre de una nueva opcion" class="form-control" aria-describedby="btnGuardarOpcion" required>
        <button class="btn btn-success btn-lg"  type="submit" id="btnGuardarOpcion">
            <i class="fa-solid fa-floppy-disk"></i>
            Insertar
        </button>
    </div>
</script>
<script id="tempImgIni" type="text/html">
    <div id="imgIni" style="display: flex;justify-content: center;align-items: center;height: 100%;">
        <div class="d-flex flex-column">
            <h3 class="text-black-50">Selecciona un encuesta de listado</h3>
            <svg width="512" height="512" x="0" y="0" viewBox="0 0 64 64">
                <use xlink:href="#docSvg"></use>
            </svg>
        </div>
    </div>
</script>
<script id="cmpSpinner" type="text/html">
    <div class="text-center m-3" id="spinner">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
</script>

<!--Fin Template underscore -->
<script src="js/main.js"></script>
</body>
</html>
